@page "/home"
@attribute [Authorize]
@using System.Timers
@using System.Security.Claims
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject AuthenticationStateProvider AuthStateProvider

<title>Home</title>
<style>
    main {
        width: 100%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
</style>

<main>
    <img src="/images/logos/Element logic logo black hires.JPG" class="d-block w-100 center" alt="Third slide">
</main>

@code {
    private string userName;
    private bool isAdmin;

    protected override async Task OnInitializedAsync()
    {
        var state = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = state.User;

        userName = user.Identity.Name;
        isAdmin = user.IsInRole("Admin");

        // Get the updated AuthenticationState again to access the latest claims
        state = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        user = state.User;

        // Access the updated claims
        var name = user.FindFirst(ClaimTypes.Name)?.Value;
        var roles = user.FindAll(ClaimTypes.Role).Select(c => c.Value).ToArray();
    }

}
